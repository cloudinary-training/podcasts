<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/video.svg" />
    <script
      src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
      integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI="
      crossorigin="anonymous"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"
    />
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

    <link
      href="https://unpkg.com/cloudinary-video-player@1.5.1/dist/cld-video-player.min.css"
      rel="stylesheet"
    />

    <script
      src="https://unpkg.com/cloudinary-core@latest/cloudinary-core-shrinkwrap.min.js"
      type="text/javascript"
    ></script>
    <script
      src="https://unpkg.com/cloudinary-video-player@1.5.1/dist/cld-video-player.min.js"
      type="text/javascript"
    ></script>

    <script src="script.js"></script>

    <title>ABS + Fancy Box</title>

    <style>
      .video-js {
        vertical-align: middle !important;
      }

      .fancybox-content {
        background: none;
      }

      .fancybox-close-small {
        background: #fff;
        border-radius: 50%;
        padding: 6px 5px 6px 6px !important;
      }

      #video-wrapper {
        width: 70vw;
      }
    </style>
  </head>

  <body>
    <div id="list" class="items flex">
      <div class="item">
        <div class="wrapper">
          <div class="media">
            <div class="image">
              <div>
                <a
                  class="fancybox video-trigger"
                  href="#video-wrapper"
                  data-video-id="podcasts/blog/mxmatters-yaron-jan2021-ready_s8jt9o"
                  data-video-poster="https://res.cloudinary.com/cloudinary-training/image/upload/w_800,h_450,c_pad,b_auto/podcasts/blog/clockface.jpg"
                >
                  Test AF
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="general-content-mod" style="background-color: #eeeef1">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-5">
            <div id="video-wrapper" style="display: none">
              <video id="sample-video-id" class="cloudinary-video cld-video-player cld-video-player-skin-dark cld-fluid controls" controls>
              </video>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      jQuery(document).ready(function () {
        jQuery(".fancybox").fancybox();
        // Initialize player
        var cloudinaryCld = cloudinary.Cloudinary.new({
          cloud_name: "cloudinary-training",
        });
        var options = {
          sourceTypes: ["hls", "mp4"],
          bigPlayButton: "init",
          muted: false,
          sourceTransformation: {
            hls: [{ streaming_profile: "hd" }],
            mp4: [{ quality: "auto" }],
          },
          playbackRates: [0.5, 1, 1.5, 2],
        };
        var media = cloudinaryCld.videoPlayer("sample-video-id", options);
        jQuery(document).on("click", ".fancybox.video-trigger", function () {
          var videoID = jQuery(this).data("video-id");
          var videoPoster = jQuery(this).data("video-poster");
          media.posterOptions({ publicId: videoPoster });
          media.source({ publicId: videoID });
        });
      });
    </script>
  </body>
</html>
